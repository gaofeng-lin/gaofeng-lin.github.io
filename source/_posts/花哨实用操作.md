---
title: 花哨使用操作
date: 2022/9/9
categories:
  - 工具
tags:
  - Linux
  - VM
abbrlink: 27392
---

## 内网穿透
[借鉴链接1](https://juejin.cn/post/6844904169497690120)
[借鉴链接2](https://xumingmingming.github.io/2019/06/28/linux/wai-wang-ssh-lian-jie-nei-wang-windows-shang-linux-xu-ni-ji/)

内网穿透，即NAT（Network Address Translator）穿透，是指计算机在内网（局域网）内使用私有IP地址，在连接外网（互联网）时使用全局IP地址的技术。该技术被普遍使用在有多台主机但只通过一个公有IP地址访问的私有网络中。

举个例子：比如我在实验室配置了一个服务器 Server A，当我在实验室的时候，就可以通过自己的笔记本使用SSH连接【因为我和服务器处于一个局域网】，当我回宿舍以后，就没有办法直接使用SSH连接了【因为我和服务器不在一个局域网】，这个时候就需要进行NAT穿透，让我在宿舍也可以使用SSH连接Server A。

### NAT原理解析
- 当信息由局域网向因特网传递时，源地址从专有地址转换为公用地址。由路由器跟踪每个连接上的目的地址和端口。
  
- 当数据返回路由器时，通过记录的连接跟踪数据来决定该转发给内部网的哪个主机；如果此时如果有多个公用地址可用，当数据包返回时，则会客户机的端口号可以用来分解数据包。

下图以10.0.0.10的主机与163.221.120.9的主机进行通信为例进行讲解。

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/5/26/17251920e32f946d~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

1. 首先NAT路由器将发送源地址从私有IP地址(10.0.0.10)转换为全局的IP地址 (202.244.174.37)再发送数据

2. 当数据从地址163.221.120.9发过来时，NAT路由器将目标地址从原句IP地址(202.244.174.37)先转换成私有IP地址10.0.0.10以后再转发

### 内网穿透工具
目前市面上有很多传统工具，较为知名的开源工具有**Ngrok、FRP、 fcn、goProxy**，其他还有一些商用的工具比如花生壳和基于等Ngrok和FRP二次开发的商用软件

详细见链接1，目前使用的是灵曜内网穿透


### 怎样判断两个IP是否在同一局域网
[原链接](https://blog.51cto.com/u_11216726/1967245)


1.在windows中，开始->cmd 进入Dos，输入ipconfig /all，查看网络配置。

2.首先看子网掩码（Subnet Mask），如果两台机器子网掩码不一致，不在一个局域网。

3.若子网掩码一致，再看IP地址的与子网掩码255对应的IP段是否一致，如果一致，属于一个子网，即一个局域网。

例如10.178.0.222与10.178.1.212两个IP地址，它们的子网掩码都是255.255.0.0，在 TCP/IP协议规则里面，IP地址与子网掩码做与运算，255换成十六进制就是FF，换成二进制就是11111111,10.178.0.222与255.255.0.0做与运算的结果是10.178.0.0，同样10.178.1.212与255.255.0.0做与运算也是10.178.0.0，因此这两个地址属于一个局域网。
而10.178.0.222与10.178.1.212两个IP地址，若它们的子网掩码都是255.255.255.0的话，他们就不属于一个局域网。这两个IP地址与子网掩码做与运算后结果分别为10.178.0.0和10.178.1.0，很明显IP不一致。
