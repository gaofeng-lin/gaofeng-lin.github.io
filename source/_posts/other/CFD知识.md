---
title: CFDçŸ¥è¯†
date: 2024/03/03
categories:
  - CFD
tags:
  - CFD
mathjax: true
abbrlink: f6b7c48b
---

## åè¯è§£é‡Š
### weno3ã€weno5
åœ¨è®¡ç®—æµä½“åŠ¨åŠ›å­¦ï¼ˆCFDï¼‰ä¸­ï¼ŒWENOï¼Œå…¨ç§°ä¸ºåŠ æƒåŸºæœ¬éæŒ¯è¡å™¨ï¼ˆWeighted Essentially Non-Oscillatoryï¼‰ï¼Œæ˜¯ä¸€ç§è¢«å¹¿æ³›åº”ç”¨çš„æ•°å€¼æ–¹æ³•ï¼Œä¸»è¦ç”¨äºè§£å†³å¯¹æµä¸»å¯¼çš„æµä½“åŠ¨åŠ›å­¦é—®é¢˜ã€‚

WENOæ–¹æ³•çš„ä¸»è¦ç‰¹ç‚¹æ˜¯èƒ½å¤Ÿåœ¨å…‰æ»‘åŒºåŸŸä¸­å®ç°é«˜é˜¶ç²¾åº¦ï¼ŒåŒæ—¶åœ¨æ¿€æ³¢å’Œä¸è¿ç»­æ€§é™„è¿‘ä¿æŒéæŒ¯è¡çš„è§£ã€‚è¿™æ˜¯é€šè¿‡å¯¹ä¸€ç»„ä¸åŒçš„é¢„æµ‹å­æ–¹æ¡ˆï¼ˆå³é¢„æµ‹å­ stencilï¼‰è¿›è¡Œéçº¿æ€§åŠ æƒæ¥å®ç°çš„ï¼Œæ¯ä¸ªé¢„æµ‹å­æ–¹æ¡ˆå¯¹åº”äºä¸åŒçš„æ’å€¼å¤šé¡¹å¼ã€‚

â€œWENO3â€å’Œâ€œWENO5â€æŒ‡çš„æ˜¯WENOæ–¹æ³•çš„ä¸åŒå˜ä½“ï¼Œæ•°å­—è¡¨ç¤ºç”¨äºæ„é€ é¢„æµ‹å­æ–¹æ¡ˆçš„æ’å€¼å¤šé¡¹å¼çš„é˜¶æ•°ã€‚ä¾‹å¦‚ï¼ŒWENO3è¡¨ç¤ºä½¿ç”¨äºŒé˜¶æ’å€¼å¤šé¡¹å¼ï¼Œè€ŒWENO5è¡¨ç¤ºä½¿ç”¨å››é˜¶æ’å€¼å¤šé¡¹å¼ã€‚**ç†è®ºä¸Šï¼ŒWENO5åœ¨å…‰æ»‘åŒºåŸŸçš„ç²¾åº¦é«˜äºWENO3ï¼Œä½†æ˜¯åœ¨æ¿€æ³¢å’Œä¸è¿ç»­æ€§é™„è¿‘ï¼ŒWENO5å’ŒWENO3çš„æ€§èƒ½å·®è·å°±ä¸é‚£ä¹ˆæ˜æ˜¾äº†ã€‚**

## CFDåŸºç¡€çŸ¥è¯†

### ç½‘æ ¼è®¡ç®—


åœ¨è®¡ç®—æµä½“åŠ¨åŠ›å­¦ï¼ˆCFDï¼‰ä¸­ï¼Œç½‘æ ¼ï¼ˆä¹Ÿç§°ä¸ºç½‘æ ¼ç‚¹æˆ–è®¡ç®—ç½‘æ ¼ï¼‰æ˜¯ç”¨äºç©ºé—´ç¦»æ•£åŒ–çš„åŸºç¡€ï¼Œå®ƒå°†è¿ç»­çš„æµä½“åŸŸåˆ’åˆ†ä¸ºä¸€ç³»åˆ—çš„ç¦»æ•£å•å…ƒæˆ–æ§åˆ¶ä½“ã€‚åœ¨è¿™äº›ç½‘æ ¼ç‚¹æˆ–ç½‘æ ¼å•å…ƒä¸Šè¿›è¡Œè®¡ç®—æ˜¯CFDæ¨¡æ‹Ÿçš„æ ¸å¿ƒè¿‡ç¨‹ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡æ±‚è§£æµä½“æµåŠ¨å’Œä¼ çƒ­ç­‰æ§åˆ¶æ–¹ç¨‹æ¥æ¨¡æ‹Ÿå’Œé¢„æµ‹æµåœºè¡Œä¸ºã€‚ä»¥ä¸‹æ˜¯å¯¹CFDè®¡ç®—ä¸­åœ¨ç½‘æ ¼ç‚¹ä¸Šè¿›è¡Œè®¡ç®—çš„åŸºæœ¬ç†è§£ï¼š

1. ç½‘æ ¼åˆ’åˆ†
ç½‘æ ¼ç±»å‹ï¼šæ ¹æ®ä¸åŒçš„éœ€æ±‚ï¼Œå¯ä»¥é€‰æ‹©ç»“æ„åŒ–ç½‘æ ¼ã€éç»“æ„åŒ–ç½‘æ ¼æˆ–æ··åˆç½‘æ ¼ã€‚ç»“æ„åŒ–ç½‘æ ¼é€šå¸¸æ˜¯è§„åˆ™çš„ã€å…·æœ‰å›ºå®šæ‹“æ‰‘ç»“æ„çš„ç½‘æ ¼ï¼Œæ˜“äºç”Ÿæˆå’Œè®¡ç®—ï¼›éç»“æ„åŒ–ç½‘æ ¼æ›´åŠ çµæ´»ï¼Œé€‚ç”¨äºå¤æ‚çš„å‡ ä½•å½¢çŠ¶ã€‚
ç½‘æ ¼å¯†åº¦ï¼šç½‘æ ¼çš„å¯†åº¦ï¼ˆå³ç½‘æ ¼ç‚¹çš„æ•°é‡å’Œåˆ†å¸ƒï¼‰ç›´æ¥å½±å“è®¡ç®—çš„ç²¾åº¦å’Œè®¡ç®—æˆæœ¬ã€‚åœ¨æµä½“æµåŠ¨çš„å…³é”®åŒºåŸŸï¼ˆå¦‚è¾¹ç•Œå±‚ã€å°¾è¿¹åŒºç­‰ï¼‰ï¼Œé€šå¸¸éœ€è¦æ›´ç»†çš„ç½‘æ ¼ä»¥æ•æ‰æµåŠ¨ç»†èŠ‚ã€‚
2. æ§åˆ¶æ–¹ç¨‹ç¦»æ•£åŒ–
æ–¹ç¨‹ç¦»æ•£åŒ–ï¼šè¿ç»­çš„æµä½“æ§åˆ¶æ–¹ç¨‹ï¼ˆå¦‚Navier-Stokesæ–¹ç¨‹ï¼‰éœ€è¦é€šè¿‡ç¦»æ•£åŒ–è¿‡ç¨‹è½¬æ¢ä¸ºä¸€ç»„å¯ä»¥åœ¨è®¡ç®—æœºä¸Šæ±‚è§£çš„ä»£æ•°æ–¹ç¨‹ã€‚å¸¸ç”¨çš„ç¦»æ•£åŒ–æ–¹æ³•åŒ…æ‹¬æœ‰é™å·®åˆ†æ³•ï¼ˆFDMï¼‰ã€æœ‰é™ä½“ç§¯æ³•ï¼ˆFVMï¼‰å’Œæœ‰é™å…ƒæ³•ï¼ˆFEMï¼‰ã€‚
è®¡ç®—è¿‡ç¨‹ï¼šåœ¨æ¯ä¸ªç½‘æ ¼ç‚¹æˆ–ç½‘æ ¼å•å…ƒä¸Šï¼Œé€šè¿‡æ±‚è§£ç¦»æ•£åŒ–åçš„æ–¹ç¨‹æ¥è®¡ç®—æµä½“çš„ç‰©ç†é‡ï¼ˆå¦‚é€Ÿåº¦ã€å‹åŠ›ã€æ¸©åº¦ç­‰ï¼‰ã€‚è¿™äº›è®¡ç®—é€šå¸¸æ¶‰åŠç½‘æ ¼ç‚¹ä¹‹é—´çš„ç›¸äº’ä½œç”¨ï¼Œä»¥åŠä¸è¾¹ç•Œæ¡ä»¶çš„å…³ç³»ã€‚
3. è¾¹ç•Œæ¡ä»¶å¤„ç†
è¾¹ç•Œæ¡ä»¶ï¼šåœ¨CFDè®¡ç®—ä¸­ï¼Œå¿…é¡»åœ¨åŸŸçš„è¾¹ç•Œä¸Šæ–½åŠ é€‚å½“çš„è¾¹ç•Œæ¡ä»¶ï¼Œè¿™äº›æ¡ä»¶å¯¹æµåœºçš„è®¡ç®—è‡³å…³é‡è¦ã€‚è¾¹ç•Œæ¡ä»¶å¯ä»¥æ˜¯é€Ÿåº¦ã€å‹åŠ›ã€æ¸©åº¦çš„å·²çŸ¥å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯æ›´å¤æ‚çš„æ¡ä»¶ï¼Œå¦‚å‘¨æœŸæ€§è¾¹ç•Œã€å¯¹ç§°æ€§è¾¹ç•Œç­‰ã€‚
åœ¨ç½‘æ ¼ç‚¹ä¸Šçš„åº”ç”¨ï¼šè¾¹ç•Œæ¡ä»¶ç›´æ¥æ–½åŠ äºä½äºæˆ–é è¿‘è¾¹ç•Œçš„ç½‘æ ¼ç‚¹ä¸Šï¼Œè¿™äº›æ¡ä»¶å°†åœ¨æ±‚è§£è¿‡ç¨‹ä¸­è¢«ç”¨æ¥è®¡ç®—è¾¹ç•Œé™„è¿‘çš„æµåœºè¡Œä¸ºã€‚
4. è¿­ä»£æ±‚è§£ä¸æ”¶æ•›
è¿­ä»£æ±‚è§£ï¼šå¯¹äºéçº¿æ€§å’Œè€¦åˆçš„æ–¹ç¨‹ç»„ï¼ŒCFDè®¡ç®—é€šå¸¸éœ€è¦é€šè¿‡è¿­ä»£æ–¹æ³•æ±‚è§£ã€‚åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œæ‰€æœ‰ç½‘æ ¼ç‚¹ä¸Šçš„ç‰©ç†é‡éƒ½ä¼šæ ¹æ®å½“å‰çš„æµåœºçŠ¶æ€å’Œç›¸äº’ä½œç”¨è¿›è¡Œæ›´æ–°ã€‚
æ”¶æ•›åˆ¤å®šï¼šé€šè¿‡ç›‘æ§æ®‹å·®å’Œå…³é”®ç‰©ç†é‡çš„å˜åŒ–æ¥åˆ¤æ–­æ±‚è§£è¿‡ç¨‹æ˜¯å¦æ”¶æ•›ã€‚å½“è¿™äº›é‡çš„å˜åŒ–é™è‡³æŸä¸ªé¢„å®šçš„é˜ˆå€¼ä»¥ä¸‹æ—¶ï¼Œå¯ä»¥è®¤ä¸ºå·²ç»è¾¾åˆ°äº†æ”¶æ•›çŠ¶æ€ï¼Œæ­¤æ—¶çš„ç½‘æ ¼ç‚¹ä¸Šçš„ç‰©ç†é‡ä»£è¡¨äº†æµåœºçš„æœ€ç»ˆè§£ã€‚

æ€»ç»“
åœ¨CFDè®¡ç®—ä¸­ï¼Œç½‘æ ¼ç‚¹ä¸Šçš„è®¡ç®—æ˜¯é€šè¿‡å°†è¿ç»­çš„æµä½“æ§åˆ¶æ–¹ç¨‹ç¦»æ•£åŒ–ï¼Œç„¶ååœ¨è¿™äº›ç¦»æ•£çš„ç‚¹ä¸Šæ±‚è§£è¿™äº›æ–¹ç¨‹æ¥å®ç°çš„ã€‚è¿™ä¸ªè¿‡ç¨‹åŒ…æ‹¬ç½‘æ ¼çš„åˆ’åˆ†ã€æ–¹ç¨‹çš„ç¦»æ•£åŒ–ã€è¾¹ç•Œæ¡ä»¶çš„æ–½åŠ ã€ä»¥åŠé€šè¿‡è¿­ä»£æ±‚è§£ç›´è‡³æ”¶æ•›çš„æ•´ä¸ªè®¡ç®—æµç¨‹ã€‚æ­£ç¡®çš„ç½‘æ ¼åˆ’åˆ†å’Œé«˜æ•ˆçš„æ±‚è§£ç­–ç•¥æ˜¯è·å¾—å‡†ç¡®å¯é CFDæ¨¡æ‹Ÿç»“æœçš„å…³é”®ã€‚

### æ”¶æ•›

åœ¨è®¡ç®—æµä½“åŠ¨åŠ›å­¦ï¼ˆCFDï¼‰ä¸­ï¼Œ"æ”¶æ•›"æ˜¯æŒ‡é€šè¿‡è¿­ä»£æ±‚è§£è¿‡ç¨‹ï¼Œè®¡ç®—å¾—åˆ°çš„æµåœºå‚æ•°ï¼ˆå¦‚é€Ÿåº¦ã€å‹åŠ›ç­‰ï¼‰éšç€è¿­ä»£æ¬¡æ•°å¢åŠ ï¼Œè¶‹äºç¨³å®šçš„ä¸€ä¸ªçŠ¶æ€ï¼Œä¸å†å‘ç”Ÿæ˜¾è‘—å˜åŒ–ã€‚æ”¶æ•›æ˜¯è¡¡é‡CFDæ¨¡æ‹Ÿæ˜¯å¦æˆåŠŸè¾¾åˆ°é¢„æœŸç‰©ç†çŠ¶æ€çš„å…³é”®æŒ‡æ ‡ä¹‹ä¸€ã€‚åœ¨CFDæ¨¡æ‹Ÿä¸­ï¼Œåˆ¤æ–­ä¸€ä¸ªè®¡ç®—æ˜¯å¦æ”¶æ•›ï¼Œé€šå¸¸ä¾æ®ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1. æ®‹å·®
æ®‹å·®æ˜¯æŒ‡å®é™…æµåœºå‚æ•°ä¸è®¡ç®—æµåœºå‚æ•°ä¹‹é—´çš„è¯¯å·®ã€‚åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œæ±‚è§£å™¨ä¼šè®¡ç®—å„ä¸ªæ–¹ç¨‹çš„æ®‹å·®ï¼Œè¿™äº›æ®‹å·®åº”å½“éšç€è¿­ä»£æ¬¡æ•°çš„å¢åŠ è€Œå‡å°ã€‚å½“æ®‹å·®é™ä½åˆ°æŸä¸ªé¢„å®šçš„é˜ˆå€¼ä»¥ä¸‹æ—¶ï¼Œå¯ä»¥è®¤ä¸ºæ±‚è§£è¿‡ç¨‹å·²ç»æ”¶æ•›ã€‚æ®‹å·®çš„é˜ˆå€¼å–å†³äºå…·ä½“çš„åº”ç”¨å’Œç²¾åº¦è¦æ±‚ï¼Œå¸¸è§çš„é˜ˆå€¼åŒ…æ‹¬e-3ã€e-4ç­‰
2. ç‰©ç†é‡çš„å˜åŒ–
é™¤äº†ç›‘è§†æ®‹å·®ä¹‹å¤–ï¼Œè¿˜éœ€è¦æ£€æŸ¥å…³é”®ç‰©ç†é‡ï¼ˆå¦‚é€Ÿåº¦ã€å‹åŠ›ã€æ¸©åº¦ç­‰ï¼‰éšè¿­ä»£æ¬¡æ•°çš„å˜åŒ–ã€‚å¦‚æœè¿™äº›ç‰©ç†é‡åœ¨è¿ç»­å‡ ä¸ªè¿­ä»£æ­¥éª¤ä¸­çš„å˜åŒ–éå¸¸å°ï¼Œé‚£ä¹ˆå¯ä»¥è®¤ä¸ºæ±‚è§£è¿‡ç¨‹å·²ç»æ”¶æ•›ã€‚å…·ä½“çš„å˜åŒ–é˜ˆå€¼åŒæ ·ä¾æ®å®é™…åº”ç”¨å’Œç²¾åº¦è¦æ±‚è€Œå®šã€‚
2. ç›‘è§†ç‚¹æˆ–ç›‘è§†é¢
åœ¨CFDæ¨¡æ‹Ÿä¸­ï¼Œå¯ä»¥è®¾ç½®ç‰¹å®šçš„ç›‘è§†ç‚¹æˆ–ç›‘è§†é¢ï¼Œç”¨æ¥è·Ÿè¸ªç‰¹å®šä½ç½®æˆ–åŒºåŸŸå†…ç‰©ç†é‡éšè¿­ä»£è¿‡ç¨‹çš„å˜åŒ–ã€‚å¦‚æœè¿™äº›ç›‘è§†ç‚¹æˆ–ç›‘è§†é¢ä¸Šçš„ç‰©ç†é‡å˜åŒ–è¶‹äºç¨³å®šï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥ä½œä¸ºæ”¶æ•›çš„ä¸€ä¸ªåˆ¤æ–­ä¾æ®ã€‚
3. æµåœºç‰¹å¾
å¯¹äºä¸€äº›ç‰¹å®šçš„æµåŠ¨é—®é¢˜ï¼Œè¿˜å¯ä»¥é€šè¿‡è§‚å¯Ÿæµåœºçš„ç‰¹å¾æ¥åˆ¤æ–­æ¨¡æ‹Ÿæ˜¯å¦æ”¶æ•›ï¼Œæ¯”å¦‚æµçº¿çš„åˆ†å¸ƒã€æ¶¡é‡çš„ç”Ÿæˆå’Œæ¶ˆæ•£ç­‰ã€‚å¦‚æœæµåœºçš„è¿™äº›ç‰¹å¾åœ¨è¿ç»­å‡ ä¸ªè¿­ä»£æ­¥éª¤ä¸­ä¿æŒç¨³å®šï¼Œé‚£ä¹ˆå¯ä»¥è®¤ä¸ºæ±‚è§£è¿‡ç¨‹æ¥è¿‘æ”¶æ•›ã€‚
4. ç»¼åˆåˆ¤æ–­
å®é™…ä¸Šï¼Œåˆ¤æ–­CFDæ¨¡æ‹Ÿæ˜¯å¦æ”¶æ•›é€šå¸¸éœ€è¦ç»¼åˆè€ƒè™‘ä»¥ä¸Šå‡ ä¸ªæ–¹é¢ã€‚å•ä¸€æŒ‡æ ‡å¯èƒ½ä¸è¶³ä»¥å‡†ç¡®åæ˜ æ•´ä¸ªæµåœºçš„æ”¶æ•›çŠ¶æ€ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤æ‚æµåŠ¨é—®é¢˜æ—¶ã€‚å› æ­¤ï¼Œè¿›è¡Œç»¼åˆåˆ¤æ–­æ˜¯éå¸¸é‡è¦çš„ã€‚

**æ”¶æ•›åè¯¥åšä»€ä¹ˆï¼Ÿ**
å½“CFDæ¨¡æ‹Ÿæœ€ç»ˆæ”¶æ•›åï¼Œè¿™æ„å‘³ç€å·²ç»å¾—åˆ°äº†ä¸€ä¸ªç¨³å®šçš„æµåœºè§£ï¼Œè¿™æ—¶å€™ä¸»è¦çš„å·¥ä½œè½¬å‘ç»“æœçš„åˆ†æå’ŒéªŒè¯ï¼Œä»¥åŠåŸºäºè¿™äº›ç»“æœçš„åç»­åº”ç”¨ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›åœ¨æ¨¡æ‹Ÿæ”¶æ•›åå¯ä»¥è¿›è¡Œçš„ä¸»è¦æ´»åŠ¨ï¼š

1. ç»“æœåˆ†æ
æµåœºç‰¹å¾åˆ†æï¼šå¯¹æµåœºä¸­çš„é€Ÿåº¦ã€å‹åŠ›ã€æ¸©åº¦ç­‰ç‰©ç†é‡è¿›è¡Œè¯¦ç»†åˆ†æï¼Œè¯†åˆ«æµåŠ¨ç‰¹å¾ï¼Œå¦‚æ¶¡æµã€åˆ†ç¦»æµã€å›æµç­‰ã€‚
æ€§èƒ½è¯„ä¼°ï¼šå¯¹äºå·¥ç¨‹åº”ç”¨ï¼Œæ ¹æ®æµåœºåˆ†æç»“æœè¯„ä¼°äº§å“çš„æ€§èƒ½ï¼Œä¾‹å¦‚ï¼Œå¯¹äºæ±½è½¦å¤–æµåœºåˆ†æï¼Œè¯„ä¼°ç©ºæ°”é˜»åŠ›ç³»æ•°ï¼›å¯¹äºç®¡é“æµåŠ¨ï¼Œè¯„ä¼°å‹é™å’Œæµé‡åˆ†é…ç­‰ã€‚
2. éªŒè¯ä¸éªŒè¯ï¼ˆV&Vï¼‰
éªŒè¯ï¼ˆVerificationï¼‰ï¼šç¡®è®¤æ•°å€¼è§£çš„æ­£ç¡®æ€§ï¼Œå³æ£€æŸ¥è®¡ç®—è¿‡ç¨‹æ˜¯å¦æ— è¯¯ï¼ŒåŒ…æ‹¬ç½‘æ ¼ç‹¬ç«‹æ€§åˆ†æã€æ•°å€¼æ–¹æ³•çš„æ­£ç¡®æ€§ç­‰ã€‚
éªŒè¯ï¼ˆValidationï¼‰ï¼šé€šè¿‡å®éªŒæ•°æ®æˆ–å…¶ä»–å¯ä¿¡æ¥æºçš„æ•°æ®æ¥éªŒè¯æ¨¡æ‹Ÿç»“æœçš„ç‰©ç†å‡†ç¡®æ€§ã€‚
3. å‚æ•°ç ”ç©¶ä¸ä¼˜åŒ–è®¾è®¡
å‚æ•°æ•æ„Ÿæ€§åˆ†æï¼šé€šè¿‡æ”¹å˜å…³é”®å‚æ•°ï¼ˆå¦‚å…¥å£æµé€Ÿã€æ¸©åº¦ã€å‡ ä½•å½¢çŠ¶ç­‰ï¼‰æ¥ç ”ç©¶å®ƒä»¬å¯¹æµåœºå’Œæ€§èƒ½çš„å½±å“ï¼Œä¸ºè®¾è®¡æä¾›ä¾æ®ã€‚
è®¾è®¡ä¼˜åŒ–ï¼šåŸºäºCFDç»“æœï¼Œåˆ©ç”¨ä¼˜åŒ–ç®—æ³•å¯»æ‰¾æœ€ä½³è®¾è®¡å‚æ•°ï¼Œä»¥æ”¹å–„æ€§èƒ½ã€é™ä½æˆæœ¬ç­‰ã€‚
4. å¤šå­¦ç§‘è€¦åˆåˆ†æ
ç»“åˆç»“æ„åŠ›å­¦ã€çƒ­ä¼ é€’ã€åŒ–å­¦ååº”ç­‰å…¶ä»–ç‰©ç†è¿‡ç¨‹çš„æ¨¡æ‹Ÿï¼Œè¿›è¡Œæ›´ä¸ºå¤æ‚çš„å¤šç‰©ç†åœºè€¦åˆåˆ†æï¼Œä»¥æ›´å…¨é¢åœ°è¯„ä¼°å’Œä¼˜åŒ–äº§å“æ€§èƒ½ã€‚


### åŒæ—¶é—´æ­¥æ³•


åœ¨è®¡ç®—æµä½“åŠ›å­¦ä¸­ï¼Œé‡‡ç”¨åŒæ—¶é—´æ­¥æ³•ï¼ˆDual Time Steppingï¼‰å¤„ç†éå®šå¸¸é—®é¢˜æ˜¯ä¸€ç§å¸¸è§çš„æŠ€æœ¯ï¼Œå°¤å…¶é€‚ç”¨äºå¤„ç†å¤æ‚çš„ç¬æ€æµåŠ¨ã€‚è¿™ç§æ–¹æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯å¼•å…¥ä¸€ä¸ªäººå·¥çš„â€œå‡â€æ—¶é—´ç»´åº¦æ¥åŠ é€Ÿæ”¶æ•›åˆ°æ¯ä¸€ä¸ªç‰©ç†æ—¶é—´æ­¥çš„è§£ï¼Œå³åœ¨ç‰©ç†æ—¶é—´æ­¥å›ºå®šçš„æƒ…å†µä¸‹ï¼Œé€šè¿‡è¿­ä»£è§£å†³ä¸€ä¸ªæˆ–å¤šä¸ªå‡æ—¶é—´æ­¥æ¥æ±‚è§£éå®šå¸¸æ–¹ç¨‹ã€‚è¿™é‡Œçš„â€œå®šé•¿â€çš„æ„æ€æ˜¯ï¼Œåœ¨è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œç‰©ç†æ—¶é—´æ­¥ä¿æŒå›ºå®šï¼Œè€Œåœ¨è¿™ä¸ªå›ºå®šçš„ç‰©ç†æ—¶é—´æ­¥å†…éƒ¨ï¼Œä½¿ç”¨å¤šä¸ªå‡æ—¶é—´æ­¥æ¥è¿­ä»£æ±‚è§£ã€‚


**å·¥ä½œåŸç†**
1. **ç‰©ç†æ—¶é—´æ­¥**ï¼šè¿™æ˜¯çœŸå®çš„æ—¶é—´æ­¥è¿›ï¼Œåæ˜ äº†æµåœºéšæ—¶é—´çš„å®é™…å˜åŒ–ã€‚

2. **å‡æ—¶é—´æ­¥**ï¼šä¸ºäº†åœ¨æ¯ä¸ªç‰©ç†æ—¶é—´æ­¥è·å¾—ç¨³å®šå’Œå‡†ç¡®çš„è§£ï¼Œå¼•å…¥ä¸€ä¸ªé¢å¤–çš„æ—¶é—´ç»´åº¦ï¼ˆç§°ä¸ºå‡æ—¶é—´ï¼‰ã€‚åœ¨æ¯ä¸ªå›ºå®šçš„ç‰©ç†æ—¶é—´æ­¥å†…ï¼Œé€šè¿‡å¤šæ¬¡è¿­ä»£å‡æ—¶é—´æ¥æ±‚è§£æµåœºï¼Œç›´åˆ°è¾¾åˆ°æŸç§æ”¶æ•›æ¡ä»¶ã€‚è¿™äº›è¿­ä»£å¸®åŠ©ç¨³å®šäº†æ±‚è§£è¿‡ç¨‹ï¼Œå¹¶ç¡®ä¿äº†ä»ä¸€ä¸ªç‰©ç†æ—¶é—´æ­¥åˆ°ä¸‹ä¸€ä¸ªç‰©ç†æ—¶é—´æ­¥çš„å¹³æ»‘è¿‡æ¸¡ã€‚


åœ¨åŒæ—¶é—´æ­¥æ³•ä¸­ï¼Œè™½ç„¶å¤„ç†çš„æ˜¯éå®šå¸¸é—®é¢˜ï¼Œç‰©ç†æ—¶é—´æ­¥æ˜¯å›ºå®šçš„ï¼Œå³åœ¨æ¯ä¸ªç‰©ç†æ—¶é—´ç‚¹ï¼Œè®¡ç®—æ¡ä»¶å¹¶ä¸æ”¹å˜ï¼Œè¿™æ ·å¯ä»¥åœ¨æ¯ä¸ªç‰©ç†æ—¶é—´æ­¥çš„è®¡ç®—ä¸­è¾¾åˆ°ä¸€ç§â€œå®šé•¿â€æˆ–ç¨³å®šçŠ¶æ€ã€‚åœ¨è¿™ç§æ„ä¹‰ä¸Šï¼Œå°½ç®¡æ•´ä½“é—®é¢˜æ˜¯éå®šå¸¸çš„ï¼ˆéšæ—¶é—´å˜åŒ–çš„ï¼‰ï¼Œæ¯ä¸ªç‰©ç†æ—¶é—´æ­¥çš„å¤„ç†è¿‡ç¨‹ç±»ä¼¼äºæ±‚è§£ä¸€ä¸ªå®šå¸¸é—®é¢˜ï¼Œå› ä¸ºåœ¨è¾¾åˆ°ç‰©ç†æ—¶é—´æ­¥çš„è§£ä¹‹å‰ï¼Œå‡æ—¶é—´çš„è¿­ä»£ä½¿å¾—è§£åœ¨è¯¥ç‰©ç†æ—¶é—´ç‚¹è¾¾åˆ°ç¨³å®šã€‚

**åº”ç”¨åœºæ™¯**

è¿™ç§æ–¹æ³•éå¸¸é€‚ç”¨äºéœ€è¦æ—¶é—´ç²¾ç¡®æ€§çš„æµåŠ¨é—®é¢˜ï¼Œå¦‚ä¸ç¨³å®šæµåŠ¨ã€æŒ¯è¡æµåŠ¨ç­‰ã€‚é€šè¿‡åœ¨æ¯ä¸ªç‰©ç†æ—¶é—´æ­¥å†…è¿­ä»£å‡æ—¶é—´æ­¥ï¼ŒåŒæ—¶é—´æ­¥æ³•å¯ä»¥æœ‰æ•ˆåœ°ç¨³å®šæ•°å€¼è§£ï¼Œå¹¶åŠ å¿«æ”¶æ•›é€Ÿåº¦ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨éšå¼æ—¶é—´ç¦»æ•£åŒ–æ–¹æ¡ˆæ—¶ã€‚


## æ•°å­¦çŸ¥è¯†

### å¥‡å¼‚å€¼åˆ†è§£
å¥‡å¼‚å€¼åˆ†è§£ï¼ˆSingular Value Decompositionï¼Œç®€ç§°SVDï¼‰ï¼Œå¯ä»¥ç”¨äºçŸ©é˜µçš„å‹ç¼©å’Œé™ç»´ï¼Œé€šè¿‡ä¿ç•™æœ€å¤§çš„å‡ ä¸ªå¥‡å¼‚å€¼åŠå…¶å¯¹åº”çš„å¥‡å¼‚å‘é‡ï¼Œå¯ä»¥è¿‘ä¼¼åŸçŸ©é˜µï¼Œè¿™åœ¨å›¾åƒå‹ç¼©å’Œæ•°æ®é™ç»´ç­‰é¢†åŸŸéå¸¸æœ‰ç”¨ã€‚åœ¨è§£å†³çº¿æ€§æœ€å°äºŒä¹˜é—®é¢˜ã€è®¡ç®—çŸ©é˜µçš„ä¼ªé€†ç­‰æ–¹é¢ï¼Œå¥‡å¼‚å€¼åˆ†è§£ä¹Ÿæ˜¯ä¸€ç§éå¸¸é‡è¦çš„å·¥å…·ã€‚


å¥‡å¼‚å€¼åˆ†è§£çš„è®¡ç®—ä¸€èˆ¬é€šè¿‡æ•°å€¼ç®—æ³•å®ç°ï¼Œæ¯”å¦‚åˆ©ç”¨QRåˆ†è§£æˆ–è€…å…¶ä»–è¿­ä»£æ–¹æ³•ï¼Œå› ä¸ºç›´æ¥è®¡ç®—å¥‡å¼‚å€¼åˆ†è§£åœ¨æ•°å€¼ä¸Šå¯èƒ½éå¸¸å¤æ‚ã€‚


ä¸‹é¢è®²è§£ä¸‹å¥‡å¼‚å€¼åˆ†è§£çš„æ ¸å¿ƒæ­¥éª¤ï¼š

**1 æ”¶é›†æ•°æ®é›†å¹¶æ„å»ºæ•°æ®çŸ©é˜µ**

å‡è®¾æˆ‘ä»¬æ”¶é›†äº†$M$ä¸ªæ—¶åˆ»çš„ç³»ç»ŸçŠ¶æ€ï¼ˆä¾‹å¦‚æµåœºæ•°æ®ï¼‰ï¼Œæ¯ä¸ªçŠ¶æ€éƒ½æ˜¯$N$ç»´çš„å‘é‡ï¼ˆä¾‹å¦‚æµä½“çš„é€Ÿåº¦çŸ¢é‡å’Œå‹åŠ›ï¼‰ã€‚å°†è¿™äº›æ•°æ®ç»„ç»‡æˆä¸€ä¸ªæ•°æ®çŸ©é˜µ$X$:
$X = [x_1,x_2,...,x_M]$

ä¸€èˆ¬æ¥è¯´ï¼ŒN>>Mã€‚åˆ—é€šå¸¸è¢«ç§°ä¸ºå¿«ç…§


**2 æ‰§è¡Œå¥‡å¼‚å€¼åˆ†è§£ï¼ˆSVDï¼‰**


$X=U\Sigma V^{T}$

U æ˜¯ $NÃ—N$ çš„å•ä½æ­£äº¤çŸ©é˜µï¼Œå…¶åˆ—å‘é‡ç§°ä¸ºå·¦å¥‡å¼‚å‘é‡ï¼Œä»£è¡¨æ•°æ®çš„ç©ºé—´æ¨¡å¼ã€‚

Î£ æ˜¯$NÃ—M$ çš„ä¸€ä¸ªå¯¹è§’å…ƒç´ ä¸ºéè´Ÿå€¼å®æ•°ã€éå¯¹è§’å…ƒç´ éƒ½ä¸º0çš„çŸ©é˜µã€‚å¯¹è§’å…ƒç´ è¢«ç§°ä¸ºå¥‡å¼‚å€¼ï¼Œç”±å¤§åˆ°å°æ’åˆ—ã€‚Xçš„ç§©ç­‰äºé0å¥‡å¼‚å€¼ä¸ªæ•°

V æ˜¯ $MÃ—M$ çš„å•ä½æ­£äº¤çŸ©é˜µï¼Œå…¶åˆ—å‘é‡ç§°ä¸ºå³å¥‡å¼‚å‘é‡ï¼Œä»£è¡¨æ—¶é—´æ¨¡å¼ã€‚


å¦‚æœXçš„åˆ—æ˜¯ä¾æ®æ—¶é—´è·å¾—çš„ç©ºé—´æµ‹é‡å€¼ï¼Œé‚£ä¹ˆUå¯¹åº”ç©ºé—´æ¨¡å¼ï¼ŒVå¯¹åº”æ—¶é—´æ¨¡å¼ã€‚


### åŸºäºPODçš„é™é˜¶æ¨¡å‹(ç‰ˆæœ¬1ï¼šä»å·¦å¥‡å¼‚å‘é‡Uæå–æ¨¡æ€)


**1 æå–ä¸»è¦PODæ¨¡æ€/æ¨¡å¼**

å…ˆæ‰§è¡Œå‰é¢çš„å¥‡å¼‚å€¼åˆ†è§£

é€‰æ‹©rä¸ªæœ€å¤§çš„å¥‡å¼‚å€¼å¯¹åº”çš„å·¦å¥‡å¼‚å‘é‡ï¼Œæ„æˆçŸ©é˜µ$U_{r}$

$ U_{r}=[u1,u2,...u_{r}] $


**æ„é€ æ¨¡æ€ç³»æ•°**


$coeff = U_r^T X$

**æ•°æ®é‡æ„**

$\tilde{\bf X}=U_r coeff$ 





**$U_{r}U_{r}^{T}$æ˜¯ä¸€ä¸ªM*Mçš„çŸ©é˜µï¼Œä½†è¿™ä¸ªçŸ©é˜µé€šå¸¸ä¸æ˜¯å•ä½çŸ©é˜µï¼Œé™¤éé€‰å–äº†æ‰€æœ‰æ¨¡æ€ã€‚æ‰€ä»¥ä¸ä¼šç›´æ¥æ¶ˆé™¤ã€‚**

**è¯¯å·®æ¥æº**ï¼šè¯¯å·®æ¥æºäº $U_{r}$ä¸­æœªåŒ…å«çš„é‚£äº›æ–¹å‘ï¼ˆå³å‰©ä½™çš„$Mâˆ’r $ä¸ªæ–¹å‘ï¼‰ã€‚è¿™äº›æ–¹å‘å¯èƒ½åŒ…å«è¾ƒå°çš„æ•°æ®å˜åŒ–ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ä¹Ÿå¯èƒ½å«æœ‰é‡è¦ä¿¡æ¯ã€‚
**è¿‘ä¼¼è´¨é‡**ï¼šè¿‘ä¼¼çš„è´¨é‡ä¾èµ–äº$r $çš„é€‰æ‹©ä»¥åŠæ•°æ®çš„æœ¬èº«ç‰¹æ€§ã€‚å¢åŠ  $r$ ä¼šæ”¹å–„è¿‘ä¼¼çš„ç²¾ç¡®åº¦ï¼Œä½†åŒæ—¶ä¼šå¢åŠ è®¡ç®—å’Œå­˜å‚¨çš„è´Ÿæ‹…ã€‚

å¦‚æœä½¿ç”¨å…¨éƒ¨æ¨¡æ€ï¼Œå½“ $r=M$ æ—¶ï¼Œ$U_{r}$æˆä¸ºä¸€ä¸ªå®Œæ•´çš„æ­£äº¤åŸºï¼Œè¦†ç›–äº†åŸå§‹æ•°æ®ç©ºé—´çš„æ‰€æœ‰ç»´åº¦ã€‚æ‰€ä»¥ï¼Œ$U$ æ˜¯ä¸€ä¸ªæ­£äº¤çŸ©é˜µï¼Œæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š

$U U^{T}=U^{T}U=I$





**ä¸Šé¢è¯´çš„é‡æ„æ˜¯æ²¡æœ‰è€ƒè™‘æ•°æ®å»ä¸­å¿ƒåŒ–çš„ã€‚å¦‚æœæ˜¯å»ä¸­å¿ƒåŒ–çš„ï¼Œè¦åœ¨å¥‡å¼‚å€¼åˆ†è§£å‰å‡å»å¹³å‡å€¼ï¼Œé‡æ„çš„æ—¶å€™è¦åŠ ä¸Šå¹³å‡å€¼ã€‚çœ‹ä¸‹é¢çš„ä»£ç ï¼š**

```
def DimensionReductionOpt(S):
    #POD analysis
    # O = 3
    # pca = PCA(n_components=O)
    pca = PCA()
    coeff = pca.fit_transform(S.T)
    
    u_mean = pca.mean_.reshape(-1,1)
    u_modes = pca.components_.T
    a0 = coeff[-1] 
    
    #Optimization
    def Obj(a):
        u = u_mean + u_modes@(a.reshape(-1,1))
        # resé€šè¿‡è¯»å–resid_glb.outæ–‡ä»¶ä¸­çš„et_resæ¥è·å–
        res = Res(u)
        obj = np.abs(res).mean()
        return obj
    # N*K = 100
    # outputs = minimize(Obj, a0, method='Nelder-Mead',tol=1e-16,options={'maxiter': int(N*K/10)})
    outputs = minimize(Obj, a0, method='Nelder-Mead',tol=1e-16,options={'maxiter': int(100/10)})
    u = u_mean + u_modes@(outputs.x.reshape(-1,1))
    return u
```

é‡æ„çš„ä»£ç å°±æ˜¯```u = u_mean + u_modes@(a.reshape(-1,1))```

è€ŒæŠ•å½±åœ¨```coeff = pca.fit_transform(S.T)```å°±å®Œæˆäº†ï¼Œè¿™ä¸ªä»£ç æ˜¯è‡ªåŠ¨è¿›è¡Œäº†å»ä¸­å¿ƒåŒ–çš„ï¼Œé‡æ„çš„æ—¶å€™è¦æŠŠå¹³å‡å€¼å†åŠ å›å»ï¼Œæ‰€ä»¥ä¸Šé¢çš„ä»£ç æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚



å®ç°ä»£ç ï¼š
```
def perform_pod(data):
    """æ‰§è¡ŒPODå¹¶é‡æ„æ•°æ®ï¼Œä½¿ç”¨SVDé¿å…å¤æ•°é—®é¢˜"""
    # æ•°æ®ä¸­å¿ƒåŒ–

    # data shape :  (100, 2)

    mean_data = np.mean(data, axis=0)
    data_centered = data - mean_data
    
    # ä½¿ç”¨SVDè¿›è¡Œåˆ†è§£
    U, Sigma, VT = np.linalg.svd(data_centered, full_matrices=False)

    print('pod U shape: ', U.shape)
    print('pod Sigma shape: ', Sigma.shape)
    print('pod VT shape: ', VT.shape)
    
    # æå–å‰å‡ ä¸ªæ¨¡æ€å’Œæ¨¡æ€ç³»æ•°
    n_modes = 2  # é€‰æ‹©å‰3ä¸ªä¸»è¦æ¨¡æ€
    modes = U[:, :n_modes]

    print('pod modes shape: ', modes.shape)

    modal_coefficients = np.diag(Sigma[:n_modes]) @ VT[:n_modes, :]

    # é‡æ„æ•°æ®ï¼Œä½¿ç”¨æ‰€æœ‰æ¨¡æ€
    reconstructed_data = np.dot(modes, modal_coefficients) + mean_data
    return reconstructed_data
```

### åŸºäºPODçš„é™é˜¶æ¨¡å‹(ç‰ˆæœ¬2ï¼Œä»å³å¥‡å¼‚å‘é‡Væå–æ¨¡æ€)




**1 æå–ä¸»è¦PODæ¨¡æ€/æ¨¡å¼**

$modes=V^T$

å¦‚æœé€‰æ‹©å‰Kä¸ªæ¨¡æ€ï¼Œé‚£ä¹ˆ$V_K^T$ç»´åº¦æ˜¯$K*M$

**2 æ¨¡æ€ç³»æ•°**

æ¨¡æ€ç³»æ•°ï¼š$coeff = X_{new}V$;å¦‚æœé€‰æ‹©å‰Kä¸ªæ¨¡æ€ï¼Œé‚£ä¹ˆ$coeff_K$ç»´åº¦æ˜¯$N*K$

$X = X_{mean} + coeff modes$

å®ç°ä»£ç ï¼š
```
def perform_pod_v(data):
    """æ‰§è¡ŒPODå¹¶é‡æ„æ•°æ®ï¼Œä½¿ç”¨SVDå¹¶é€‰å–Vä½œä¸ºæ¨¡æ€"""
    # æ•°æ®ä¸­å¿ƒåŒ–
    mean_data = np.mean(data, axis=0)
    data_centered = data - mean_data
    
    # ä½¿ç”¨SVDè¿›è¡Œåˆ†è§£
    U, Sigma, VT = np.linalg.svd(data_centered, full_matrices=False)
    
    # æå–å‰å‡ ä¸ªæ¨¡æ€å’Œæ¨¡æ€ç³»æ•°
    n_modes = 2  # é€‰æ‹©å‰2ä¸ªä¸»è¦æ¨¡æ€
    modes = VT[:n_modes, :]  # ä½¿ç”¨Vçš„è½¬ç½®çš„å‰n_modesè¡Œ

    print('pod_v modes shape: ', modes.shape)

    modal_coefficients = U[:, :n_modes] @ np.diag(Sigma[:n_modes])

    # é‡æ„æ•°æ®
    reconstructed_data = modal_coefficients @ modes + mean_data
    return reconstructed_data
```


### podçš„ä¸åŒå®ç°æ–¹å¼

podçš„å®ç°æ–¹å¼å¤§ä½“æœ‰ä¸¤ç§ï¼Œæ ¸å¿ƒçš„å…³é”®åœ¨äºçŸ©é˜µçš„åˆ†è§£ï¼Œç”¨svdåˆ†è§£ï¼Œè¿˜æ˜¯ä¼ ç»Ÿçš„ç‰¹å¾å€¼åˆ†è§£ã€‚

ä¸‹é¢æˆ‘ç”¨ä»£ç æ¥é˜è¿°ä¸‹ï¼š


#### svdåˆ†è§£ 
```
def generate_data(n_time_steps):
    """ç”Ÿæˆä¸€ä¸ªç®€å•çš„ç¤ºä¾‹æ•°æ®é›†"""
    t = np.linspace(0, 2 * np.pi, n_time_steps)
    data = np.array([np.sin(t), np.cos(t)]).T  # 2å˜é‡ï¼Œnæ—¶é—´æ­¥
    print('data shape : ', data.shape)
    return t, data

def perform_pod(data):
    """æ‰§è¡ŒPODå¹¶é‡æ„æ•°æ®ï¼Œä½¿ç”¨SVDé¿å…å¤æ•°é—®é¢˜"""
    # æ•°æ®ä¸­å¿ƒåŒ–
    mean_data = np.mean(data, axis=0)
    data_centered = data - mean_data
    
    # ä½¿ç”¨SVDè¿›è¡Œåˆ†è§£
    U, Sigma, VT = np.linalg.svd(data_centered, full_matrices=False)

    
    # æå–å‰å‡ ä¸ªæ¨¡æ€å’Œæ¨¡æ€ç³»æ•°
    n_modes = 2  # é€‰æ‹©å‰3ä¸ªä¸»è¦æ¨¡æ€
    modes = U[:, :n_modes]
    modal_coefficients = np.diag(Sigma[:n_modes]) @ VT[:n_modes, :]

    # é‡æ„æ•°æ®ï¼Œä½¿ç”¨æ‰€æœ‰æ¨¡æ€
    reconstructed_data = np.dot(modes, modal_coefficients) + mean_data
    return reconstructed_data

def perform_pod_pca(data):
    """æ‰§è¡ŒPODå¹¶é‡æ„æ•°æ®ï¼Œä½¿ç”¨SVDé¿å…å¤æ•°é—®é¢˜"""
    # æ•°æ®ä¸­å¿ƒåŒ–

    pca = PCA(n_components=2)
    coeff = pca.fit_transform(data)
    u_mean = pca.mean_.reshape(-1,1)
    u_modes = pca.components_.T

    reconstructed_data = u_mean + np.dot(u_modes, coeff.T)


    return reconstructed_data.T

```
ä¸Šé¢çš„ä¸¤ä¸ªå‡½æ•°perform_pod_pcaå’Œperform_podï¼Œä½ å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªè¯¦ç»†ç‰ˆçš„ï¼Œå¦ä¸€ä¸ªæ˜¯ç²—ç•¥ç‰ˆçš„ã€‚

**å…³äºpodçš„è¾“å…¥æ²¡æœ‰æ˜ç¡®çš„è§„å®šï¼Œå³æ ·æœ¬æ•°å’Œç‰¹å¾æ•°è°åœ¨å‰éƒ½æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ä¼šå¯¹ç»“æœæœ‰äº›å½±å“ï¼Œä½†æ˜¯ä¸å¤§ã€‚**

gptå¯¹æ­¤çš„è§£é‡Šæ˜¯ï¼š
1. åˆ†ææ—¶é—´ä¸Šçš„å˜åŒ–æ¨¡å¼
  
å¦‚æœä½ ä¸»è¦å…³æ³¨å¦‚ä½•åœ¨ä¸åŒæ—¶é—´ç‚¹æ•æ‰æµåœºçš„å˜åŒ–æ¨¡å¼ï¼Œä½ å¯ä»¥å°†æ¯ä¸ªæ—¶é—´ç‚¹çš„æµåœºæ•°æ®çœ‹ä½œä¸€ä¸ªç‰¹å¾å‘é‡ã€‚mï¼ˆæ ·æœ¬æ•°ï¼‰ï¼šå¯¹åº”äºæ—¶é—´ç‚¹çš„æ•°é‡ï¼Œåœ¨ä½ çš„æ¡ˆä¾‹ä¸­ï¼Œè¿™æ˜¯10ï¼ˆä½ æœ‰10ä¸ªä¸åŒæ—¶é—´ç‚¹çš„æµåœºæ•°æ®ï¼‰ã€‚nï¼ˆç‰¹å¾æ•°ï¼‰ï¼šå¯¹åº”äºæ¯ä¸ªæ—¶é—´ç‚¹çš„æ•°æ®ç‚¹æ•°é‡ï¼Œåœ¨ä½ çš„æ¡ˆä¾‹ä¸­ï¼Œè¿™æ˜¯201ï¼ˆæ¯ä¸ªæ—¶é—´ç‚¹æœ‰201ä¸ªæµåœºæ•°æ®ç‚¹ï¼‰ã€‚
è¿™æ ·ï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªæ—¶é—´ç‚¹çš„å®Œæ•´æµåœºï¼Œåˆ—æ•°åˆ™ä»£è¡¨æ¯ä¸ªæ—¶é—´ç‚¹è¢«è®°å½•çš„æµåœºæ•°æ®ç‚¹ã€‚

2. åˆ†æç©ºé—´ç‰¹å¾

å¦‚æœä½ å…³æ³¨åœ¨æ‰€æœ‰æ—¶é—´ç‚¹ä¸Šå„ä¸ªç‰¹å®šç©ºé—´ä½ç½®çš„è¡Œä¸ºï¼Œä½ å¯èƒ½ä¼šé€‰æ‹©å°†æ¯ä¸ªç©ºé—´ç‚¹çš„æ—¶é—´åºåˆ—è§†ä¸ºä¸€ä¸ªç‰¹å¾å‘é‡ã€‚mï¼ˆæ ·æœ¬æ•°ï¼‰ï¼šå¯¹åº”äºç©ºé—´ç‚¹çš„æ•°é‡ï¼Œå³201ï¼ˆæ¯ä¸ªæ—¶é—´ç‚¹201ä¸ªæ•°æ®ç‚¹ï¼‰ã€‚
nï¼ˆç‰¹å¾æ•°ï¼‰ï¼šå¯¹åº”äºæ—¶é—´ç‚¹çš„æ•°é‡ï¼Œå³10ï¼ˆä½ æœ‰10ä¸ªæ—¶é—´çš„æµåœºæ•°æ®ï¼‰ã€‚
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªå›ºå®šç©ºé—´ä½ç½®åœ¨æ‰€æœ‰è®°å½•æ—¶é—´ç‚¹çš„æµåœºå˜åŒ–ã€‚

#### ç‰¹å¾åˆ†è§£ 

```
# ç‰¹å¾å€¼åˆ†è§£
def perform_pod_eig(data):
    """æ‰§è¡ŒPODå¹¶é‡æ„æ•°æ®"""
    # æ•°æ®ä¸­å¿ƒåŒ–
    mean_data = np.mean(data, axis=1).reshape(-1, 1)
    data_centered = data - mean_data
    
    # æ„å»ºåæ–¹å·®çŸ©é˜µ
    covariance_matrix = np.dot(data_centered, data_centered.T) / data_centered.shape[1]
    
    # ç‰¹å¾åˆ†è§£
    eigenvalues, eigenvectors = np.linalg.eig(covariance_matrix)
    
    # æ’åºç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡
    idx = eigenvalues.argsort()[::-1]
    eigenvalues = eigenvalues[idx]
    eigenvectors = eigenvectors[:, idx]
    
    # æå–å‰å‡ ä¸ªæ¨¡æ€å’Œæ¨¡æ€ç³»æ•°
    n_modes = 2  # é€‰æ‹©å‰3ä¸ªä¸»è¦æ¨¡æ€
    modes = eigenvectors[:, :n_modes]
    modal_coefficients = np.dot(modes.T, data_centered)
    
    # é‡æ„æ•°æ®
    reconstructed_data = np.dot(modes, modal_coefficients) + mean_data
    return reconstructed_data
```

### PODæ€»ç»“

------------------------------
**ä¸è®ºè¾“å…¥çŸ©é˜µçš„ç»´åº¦æ˜¯$n * m$è¿˜æ˜¯$m * n$ï¼Œæ¨¡æ€ä»Uè¿˜æ˜¯Vä¸­é€‰æ‹©ï¼Œæœ€åé‡æ„å‡ºæ¥çš„å€¼éƒ½æ˜¯ä¸€æ ·çš„ã€‚**

------------------------------
:exclamation::exclamation::exclamation: ä¸Šé¢çš„å›ç­”æ˜¯é”™çš„ï¼Œå¦‚æœæŠŠæ•°æ®è®¾ç½®çš„å¤æ‚ç‚¹ï¼Œå°±ä¼šå‡ºç°å·®å¼‚,åªä¸è¿‡å·®å¼‚æ¯”è¾ƒå°


ä¸‹é¢çš„ä»£ç å¯ä»¥ç›´æ¥è¿è¡Œï¼ŒéªŒè¯ä¸Šé¢çš„å›ç­”ï¼š
```python
import numpy as np
import matplotlib.pyplot as plt
from sklearn.decomposition import PCA

from sklearn.linear_model import LinearRegression

# è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸ºäº†ç¡®å®šæ¨¡æ€æ˜¯ä»å·¦å¥‡å¼‚å‘é‡è¿˜æ˜¯å³å¥‡å¼‚å‘é‡é‡Œé¢è·å¾—çš„

def generate_data(n_time_steps):
    """ç”Ÿæˆä¸€ä¸ªç®€å•çš„ç¤ºä¾‹æ•°æ®é›†"""
    t = np.linspace(0, 2 * np.pi, n_time_steps)
    data = np.array([np.sin(t), np.cos(t), np.cos(t)*np.sin(t)]).T  # 2å˜é‡ï¼Œnæ—¶é—´æ­¥

    return t, data

def perform_pod_u(data):
    """æ‰§è¡ŒPODå¹¶é‡æ„æ•°æ®ï¼Œä½¿ç”¨SVDé¿å…å¤æ•°é—®é¢˜"""
    # æ•°æ®ä¸­å¿ƒåŒ–

    # data shape :  (100, 2)

    mean_data = np.mean(data, axis=0)
    data_centered = data - mean_data
    
    # ä½¿ç”¨SVDè¿›è¡Œåˆ†è§£
    U, Sigma, VT = np.linalg.svd(data_centered, full_matrices=False)

    print('pod_u U shape: ', U.shape)
    print('pod_u Sigma shape: ', Sigma.shape)
    print('pod_u VT shape: ', VT.shape)
    
    # æå–å‰å‡ ä¸ªæ¨¡æ€å’Œæ¨¡æ€ç³»æ•°
    n_modes = 20  # é€‰æ‹©å‰3ä¸ªä¸»è¦æ¨¡æ€
    modes = U[:, :n_modes]

    print('u pod modes shape: ', modes.shape)

    modal_coefficients = np.diag(Sigma[:n_modes]) @ VT[:n_modes, :]

    print("pod_u modal_coefficients shape: ", modal_coefficients.shape)

    # é‡æ„æ•°æ®ï¼Œä½¿ç”¨æ‰€æœ‰æ¨¡æ€
    reconstructed_data = np.dot(modes, modal_coefficients) + mean_data
    return reconstructed_data

def perform_pod_v(data):
    """æ‰§è¡ŒPODå¹¶é‡æ„æ•°æ®ï¼Œä½¿ç”¨SVDå¹¶é€‰å–Vä½œä¸ºæ¨¡æ€"""
    # æ•°æ®ä¸­å¿ƒåŒ–
    mean_data = np.mean(data, axis=0)
    data_centered = data - mean_data
    
    # ä½¿ç”¨SVDè¿›è¡Œåˆ†è§£
    U, Sigma, VT = np.linalg.svd(data_centered, full_matrices=False)
    
    # æå–å‰å‡ ä¸ªæ¨¡æ€å’Œæ¨¡æ€ç³»æ•°
    n_modes = 20  # é€‰æ‹©å‰2ä¸ªä¸»è¦æ¨¡æ€
    modes = VT[:n_modes, :]  # ä½¿ç”¨Vçš„è½¬ç½®çš„å‰n_modesè¡Œ

    print('pod_v U shape: ', U.shape)
    print('pod_v Sigma shape: ', Sigma.shape)
    print('pod_v VT shape: ', VT.shape)

    print('v pod modes shape: ', modes.shape)
    modal_coefficients = U[:, :n_modes] @ np.diag(Sigma[:n_modes])

    print("pod_v modal_coefficients shape: ", modal_coefficients.shape)

    # é‡æ„æ•°æ®
    reconstructed_data = modal_coefficients @ modes + mean_data
    return reconstructed_data

def perform_pod_pca(data):
    """æ‰§è¡ŒPODå¹¶é‡æ„æ•°æ®ï¼Œä½¿ç”¨SVDé¿å…å¤æ•°é—®é¢˜"""
    # æ•°æ®ä¸­å¿ƒåŒ–

    # pca = PCA(n_components=2)
    pca = PCA(n_components=20)
    coeff = pca.fit_transform(data)
    u_mean = pca.mean_.reshape(-1,1)
    u_modes = pca.components_.T
    
    print('u_mean: ', u_mean.shape)
    
    print('u_modes: ', u_modes.shape)
    
    print('coeff: ', coeff.shape)

    reconstructed_data = u_mean + np.dot(u_modes, coeff.T)


    return reconstructed_data.T

def compare_arrays(arr1, arr2):
    """æ¯”è¾ƒä¸¤ä¸ªnumpyæ•°ç»„çš„ç»Ÿè®¡å·®å¼‚"""
    if arr1.shape != arr2.shape:
        raise ValueError("Arrays must have the same dimensions")
    
    # è®¡ç®—å·®å¼‚æ•°ç»„
    difference = arr1 - arr2

    # è®¡ç®—å¹³å‡å€¼å·®å¼‚
    mean_difference = np.mean(difference)
    
    # è®¡ç®—æœ€å¤§å€¼å’Œæœ€å°å€¼å·®å¼‚
    max_difference = np.max(difference)
    min_difference = np.min(difference)
    
    # è¾“å‡ºç»“æœ
    print("Mean Difference:", mean_difference)
    print("Max Difference:", max_difference)
    print("Min Difference:", min_difference)

# ç”Ÿæˆæ•°æ®
n_time_steps = 100
t, data = generate_data(n_time_steps)

data = np.random.rand(20,10000)

# data = data.T

print('data shape: ', data.shape)

reconstructed_data0 = perform_pod_u(data)

# reconstructed_data1 = perform_pod_v(data)
reconstructed_data1 = perform_pod_u(data.T)

reconstructed_data2 = perform_pod_pca(data)

compare_arrays(reconstructed_data1.T, reconstructed_data0)


```


---------------------------------

ä»£ç ä¸­ï¼š

U, Sigma, VT = np.linalg.svd(data_centered, full_matrices=False)

å¦‚æœfull_matrices=Falseï¼Œè¿”å›çš„Uå’ŒVæ˜¯ç»æµå°ºå¯¸ï¼Œä»…ä»…åŒ…å«æœ‰æ„ä¹‰çš„å¥‡å¼‚å€¼ä¿¡æ¯ã€‚

å‡è®¾Xæ˜¯M*N

Uçš„å½¢çŠ¶ï¼šM * min(M,N)
Vçš„å½¢çŠ¶ï¼šN * min(M,N)

ä»£ç ä¸­ï¼š
```
u_modes = pca.components_.T
```
å½¢çŠ¶å’ŒVä¸€æ ·ï¼Œè¯´æ˜é»˜è®¤é€‰æ‹©çš„æ¨¡æ€æ˜¯ä»å³å¥‡å¼‚çŸ©é˜µVé‡Œé¢é€‰æ‹©çš„ã€‚

ä¸‹é¢çš„ä¸€æ®µä»£ç æ˜¯å¯ä»¥è¿è¡Œçš„ï¼Œæ¶‰åŠpodä¸‰ç§ä¸åŒçš„ä»£ç å†™æ³•ï¼Œç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼š

```
import numpy as np
import matplotlib.pyplot as plt
from sklearn.decomposition import PCA

from sklearn.linear_model import LinearRegression

# è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸ºäº†ç¡®å®šæ¨¡æ€æ˜¯ä»å·¦å¥‡å¼‚å‘é‡è¿˜æ˜¯å³å¥‡å¼‚å‘é‡é‡Œé¢è·å¾—çš„

def generate_data(n_time_steps):
    """ç”Ÿæˆä¸€ä¸ªç®€å•çš„ç¤ºä¾‹æ•°æ®é›†"""
    t = np.linspace(0, 2 * np.pi, n_time_steps)
    data = np.array([np.sin(t), np.cos(t), np.cos(t)*np.sin(t)]).T  # 2å˜é‡ï¼Œnæ—¶é—´æ­¥

    return t, data

def perform_pod_u(data):
    """æ‰§è¡ŒPODå¹¶é‡æ„æ•°æ®ï¼Œä½¿ç”¨SVDé¿å…å¤æ•°é—®é¢˜"""
    # æ•°æ®ä¸­å¿ƒåŒ–

    # data shape :  (100, 2)

    mean_data = np.mean(data, axis=0)
    data_centered = data - mean_data
    
    # ä½¿ç”¨SVDè¿›è¡Œåˆ†è§£
    U, Sigma, VT = np.linalg.svd(data_centered, full_matrices=False)

    print('pod U shape: ', U.shape)
    print('pod Sigma shape: ', Sigma.shape)
    print('pod VT shape: ', VT.shape)
    
    # æå–å‰å‡ ä¸ªæ¨¡æ€å’Œæ¨¡æ€ç³»æ•°
    n_modes = 2  # é€‰æ‹©å‰3ä¸ªä¸»è¦æ¨¡æ€
    modes = U[:, :n_modes]

    print('pod modes shape: ', modes.shape)

    modal_coefficients = np.diag(Sigma[:n_modes]) @ VT[:n_modes, :]

    # é‡æ„æ•°æ®ï¼Œä½¿ç”¨æ‰€æœ‰æ¨¡æ€
    reconstructed_data = np.dot(modes, modal_coefficients) + mean_data
    return reconstructed_data

def perform_pod_v(data):
    """æ‰§è¡ŒPODå¹¶é‡æ„æ•°æ®ï¼Œä½¿ç”¨SVDå¹¶é€‰å–Vä½œä¸ºæ¨¡æ€"""
    # æ•°æ®ä¸­å¿ƒåŒ–
    mean_data = np.mean(data, axis=0)
    data_centered = data - mean_data
    
    # ä½¿ç”¨SVDè¿›è¡Œåˆ†è§£
    U, Sigma, VT = np.linalg.svd(data_centered, full_matrices=False)
    
    # æå–å‰å‡ ä¸ªæ¨¡æ€å’Œæ¨¡æ€ç³»æ•°
    n_modes = 2  # é€‰æ‹©å‰2ä¸ªä¸»è¦æ¨¡æ€
    modes = VT[:n_modes, :]  # ä½¿ç”¨Vçš„è½¬ç½®çš„å‰n_modesè¡Œ

    print('pod_v modes shape: ', modes.shape)

    modal_coefficients = U[:, :n_modes] @ np.diag(Sigma[:n_modes])

    # é‡æ„æ•°æ®
    reconstructed_data = modal_coefficients @ modes + mean_data
    return reconstructed_data

def perform_pod_pca(data):
    """æ‰§è¡ŒPODå¹¶é‡æ„æ•°æ®ï¼Œä½¿ç”¨SVDé¿å…å¤æ•°é—®é¢˜"""
    # æ•°æ®ä¸­å¿ƒåŒ–

    # pca = PCA(n_components=2)
    pca = PCA(n_components=2)
    coeff = pca.fit_transform(data)
    u_mean = pca.mean_.reshape(-1,1)
    u_modes = pca.components_.T
    
    print('u_mean: ', u_mean.shape)
    
    print('u_modes: ', u_modes.shape)
    
    print('coeff: ', coeff.shape)

    reconstructed_data = u_mean + np.dot(u_modes, coeff.T)

    return reconstructed_data.T

def compare_arrays(arr1, arr2):
    """æ¯”è¾ƒä¸¤ä¸ªnumpyæ•°ç»„çš„ç»Ÿè®¡å·®å¼‚"""
    if arr1.shape != arr2.shape:
        raise ValueError("Arrays must have the same dimensions")
    
    # è®¡ç®—å·®å¼‚æ•°ç»„
    difference = arr1 - arr2
    
    # è®¡ç®—å¹³å‡å€¼å·®å¼‚
    mean_difference = np.mean(difference)
    
    # è®¡ç®—æœ€å¤§å€¼å’Œæœ€å°å€¼å·®å¼‚
    max_difference = np.max(difference)
    min_difference = np.min(difference)
    
    # è¾“å‡ºç»“æœ
    print("Mean Difference:", mean_difference)
    print("Max Difference:", max_difference)
    print("Min Difference:", min_difference)


# ç”Ÿæˆæ•°æ®
n_time_steps = 100
t, data = generate_data(n_time_steps)


# data = data.T

print('data shape: ', data.shape)

reconstructed_data0 = perform_pod_u(data)

reconstructed_data1 = perform_pod_v(data)

reconstructed_data2 = perform_pod_pca(data)

compare_arrays(reconstructed_data1, reconstructed_data2)
```


### DMD(Dynamic Mode Decomposition)

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ—¶é—´åºåˆ—æ•°æ®çŸ©é˜µ$X$ï¼Œå…¶ä¸­æ¯ä¸€åˆ—æ˜¯ç³»ç»Ÿåœ¨æŸä¸€æ—¶åˆ»çš„çŠ¶æ€å‘é‡ã€‚æˆ‘ä»¬å°†æ•°æ®åˆ’åˆ†æˆä¸¤ä¸ªçŸ©é˜µ$X_1, X_2$ã€‚å®ƒä»¬åˆ†åˆ«åŒ…å«ä»æ—¶é—´$ğ‘¡_1$åˆ°$ğ‘¡_{m-1}$å’Œ$ğ‘¡_2$åˆ°$ğ‘¡_{m}$çš„çŠ¶æ€ï¼š

#### æ”¶é›†æ•°æ®

X1 = [x1,x2,...,$x_{m-1}$] (nÃ—(m-1))

X2 = [x2,x3,...,$x_{m}$]  (nÃ—(m-1))

#### è®¡ç®—çŸ©é˜µAçš„è¿‘ä¼¼

DMDç®—æ³•å¯»æ±‚åœ¨æ—¶é—´ä¸Šä¸ä¸¤ä¸ªå¿«ç…§çŸ©é˜µç›¸å…³çš„æœ€ä½³æ‹Ÿåˆçº¿æ€§ç®—å­Açš„ä¸»å¯¼è°±åˆ†è§£ï¼ˆç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ï¼‰

$\mathbf{X}_2\approx\mathbf{A}\mathbf{X}_1$

(nÃ—n)

ä¸ºäº†æ‰¾åˆ°æœ€å¥½çš„çº¿æ€§è¿‘ä¼¼$A$ï¼Œæˆ‘ä»¬ä½¿ç”¨æœ€å°äºŒä¹˜æ³•æ±‚è§£

$\mathbf{A}=\mathbf{X}_2\mathbf{X}_1^{+}$


(nÃ—n)


#### å¥‡å¼‚å€¼åˆ†è§£

$\mathbf{X}_{1}=\mathbf{U}\mathbf{\Sigma}\mathbf{V}^{\ast}$

(nÃ—(m-1))Â =Â (nÃ—r)(rÃ—r)(rÃ—(m-1))

å…¶ä¸­
$\mathbf{U}\in\mathbb{R}^{n\times r}$

$\textstyle\sum\in\mathbb{R}^{r\times r}$

${\bf V}\in\mathbb{R}^{(m-1)\times r}$

ræ˜¯$X_1$çš„ç§©

#### æ„å»ºä½ç§©åŠ¨æ€çŸ©é˜µ $A_r$

åˆ©ç”¨ SVD çš„ç»“æœæ„å»ºä¸€ä¸ªä½ç§©è¿‘ä¼¼çŸ©é˜µï¼š

$\mathbf{A}_r = \mathbf{U}^\ast\mathbf{A}\mathbf{U}$ 
ï¼ˆr*rï¼‰

å¾ˆå¤šå…¬å¼æˆ–è®ºæ–‡é‡Œé¢ä¼šæŠŠ$A_r$ å†™ä¸º$\tilde{A}$ã€‚

#### ç‰¹å¾åˆ†è§£

$\mathrm{A}_{r}\,\mathrm{W}=\,\mathrm{W\Lambda}$  (r*r)

å…¶ä¸­ï¼ŒWæ˜¯ç‰¹å¾å‘é‡çŸ©é˜µï¼Œ$\Lambda$æ˜¯ç‰¹å¾å€¼çŸ©é˜µã€‚ç»´åº¦éƒ½æ˜¯r*r

#### è®¡ç®—DMDæ¨¡æ€

$\Phi=\mathbf{X}_{2}\mathbf{V}\Sigma^{-1}\mathbf{W}$

ç»´åº¦æ˜¯(n*r)

**è¿™ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ä¸‹ï¼Œæœ‰çš„åœ°æ–¹å…³äºæ¨¡æ€çš„å…¬å¼æ˜¯ä¸‹é¢è¿™ä¸ªï¼š**

$\Phi=UW$

è¿™æ˜¯åˆåçš„æŠ•å½±æ¨¡æ€ã€‚ç¬¬ä¸€ä¸ªå†™æ³•æ˜¯ç²¾ç¡®è¡¨ç¤ºï¼Œå¦‚æœè®¡ç®—å‡ºæ¥çš„$\Phi$æ˜¯0ï¼Œé‚£ä¹ˆå°±é‡‡ç”¨ç¬¬äºŒä¸ªè®¡ç®—ã€‚å…·ä½“çš„åŒºåˆ«å¯ä»¥å‚è€ƒã€Šæ•°æ®é©±åŠ¨çš„ç§‘å­¦å’Œå·¥ç¨‹ã€‹p197ã€‚

#### æ•°æ®é‡æ„

$\mathbf{x}(t)=\Phi\Lambda^{t-1}\mathbf{b}$ï¼Œç»´åº¦æ˜¯n*1

å…¶ä¸­
$\mathbf{b}=\Phi\cdot\mathbf{x}_{1}$ï¼Œ ç»´åº¦æ˜¯r*1

$\Lambda^{t-1}$å°±æ˜¯$\Lambda$é‡Œé¢æ¯ä¸ªå…ƒç´ çš„(t-1)æ¬¡æ–¹ã€‚

è¿™æ ·é‡æ„å“ªä¸ªæ—¶åˆ»çš„æ•°æ®å°±ä½¿ç”¨å¯¹åº”çš„æ¬¡æ–¹

#### é¢„æµ‹æ•°æ®

å’Œä¸Šé¢çš„é‡æ„æ•°æ®ä¸€æ ·ï¼Œå‡è®¾tçš„èŒƒå›´æ˜¯1<=t<=5ã€‚t=6æ—¶åˆ»çš„æ•°æ®ä¸ºï¼š

$\mathbf{x}(6)=\Phi\Lambda^{5}\mathbf{b}$

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæˆ‘ä»¬æ˜¯åŸºäºç¬¬ä¸€ä¸ªæ—¶é—´æ­¥çš„æ•°æ®æ¥è¿›è¡Œé¢„æµ‹ï¼Œå¦‚æœæ˜¯åŸºäºæœ€åä¸€ä¸ªæ—¶é—´æ­¥çš„æ•°æ®æ¥è¿›è¡Œé¢„æµ‹ï¼Œé‚£ä¹ˆbä¼šå‘ç”Ÿå˜åŒ–
$\mathbf{b}=\Phi\cdot\mathbf{x}_{5}$

é¢„æµ‹æœªæ¥ä¸€ä¸ªæ—¶é—´æ­¥çš„æ•°æ®å˜ä¸ºï¼š
$\mathbf{x}(6)=\Phi\Lambda^{1}\mathbf{b}$


é¢„æµ‹æœªæ¥æ—¶é—´æ­¥æ•°æ®è¿˜æœ‰å¦å¤–ä¸€ç§å†™æ³•ï¼š


$\mathbf{x}(t)=\Phi{}e^{\omega t}b$

å…¶ä¸­$\omega={\frac{\log(\lambda)}{d t}}$